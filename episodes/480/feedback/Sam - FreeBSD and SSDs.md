Dear BSDNow Gents,

First, thanks for both soliciting and *answering* questions from your listeners. BSDNow is a fantastic resource to the open source community.

Second, a question about SSDs and the lies they tell us. After learning about OpenZFS 2.0's native encryption capability on your show in the fall, I spent the holiday season upgrading my home server to 13.0 to take advantage of its inclusion in that release. After the OS upgrade, I added two consumer-grade, 500GB SSDs from what I thought was a reputable vendor (Crucial) with the intent of making a mirrored zpool over them on which to start encrypting datasets. When I first installed the drives, I created separate zpools on them taking up the whole of each drive, leaving me with two approximately 500GB pools. The zpool utility didn't complain, and df showed I had two 500GB filesystems mounted. The next day, I tried reformatting them into a mirrored pool, and things went wrong quickly. The zpool utility errored, saying that the drives weren't the same size. Checking the drives with a few different utilities, they now appeared to have a size of just 7.4GB! To confirm it wasn't FreeBSD and the utilities, a reboot of the server into its firmware's boot menu showed it, too, thought the drives were only 7GB large. Puzzled, I removed both of the drives, attached them to a Fedora workstation, and found that Fedora merrily hummed along thinking they were both 500GB drives; for days at a time! Fedora even let me write data far in excess of 7GB to them without error, and utilities like fdisk reported they were their advertised size. I RMA'd one of the drives, and the replacement I was sent had the same issue. Unable to find anyone on the web who reported the same problem, I ultimately gave up and just got new drives of the same make and model that my server uses as its boot disk (Western Digital), and haven't had any problems.

Have any of you ever encountered this problem, or have a guess at what was going wrong? Why would an SSD appear to FreeBSD as its advertised size for a day, and then another size thereafter? And all the while, Fedora not seeing anything wrong with them? Could the SATA hardware on my server have somehow been to blame? Are SSDs "smart" enough to lie about themselves in different ways, to different operating systems? The chapter on storage in Lucas's "Absolute FreeBSD" was enough to make me never trust storage devices again; are there any vendors making SSDs that don't lie so much, or at least tell the same lie consistently?

Thanks,
Sam.

P.S. I understand that Allan played a role in the release of the zfskeys rc script in 13.1. Thank you for this! While it was a good exercise for me to crib a script from the FreeBSD forums that did about the same job, it's nice to have an official solution for decryption at boot.
